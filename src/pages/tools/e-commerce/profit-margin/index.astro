---
import BaseLayout from "../../../../components/layout/BaseLayout.astro";
import { site } from "../../../../config/site";
---

<BaseLayout
  title="Profit Margin Calculator — Free & Instant | SimpleTools"
  description="Free profit margin calculator for US e-commerce sellers. Calculate net profit and net margin after COGS, platform fees, payment fees, shipping, and ad spend."
>
  <main class="st_calc">
    <!-- Header -->
    <header class="st_calcHeader container">
      <div class="st_badgeRow">
        <span class="st_badge">Free • No login • Instant</span>
      </div>
      <h1 class="st_calcTitle">Profit Margin Calculator</h1>
      <p class="st_calcLead">
        Calculate real net profit and net margin after product cost, platform fees, payment fees, shipping, and ad spend.
        Built for US sellers (USD + percent-based fees).
      </p>
    </header>

    <!-- Calculator: 2-column on desktop -->
    <section class="container st_calcGrid" aria-label="Calculator">
      <!-- Left: Inputs -->
      <div class="st_card st_inputs" aria-label="Inputs">
        <h2 class="st_cardTitle">Inputs</h2>

        <div class="st_form">
          <label class="st_field">
            <span class="st_label">Selling price (USD)</span>
            <input id="pm_price" class="st_input" type="number" step="0.01" min="0" placeholder="e.g. 49.99" />
          </label>

          <label class="st_field">
            <span class="st_label">Product cost (COGS)</span>
            <input id="pm_cogs" class="st_input" type="number" step="0.01" min="0" placeholder="e.g. 15.00" />
          </label>

          <div class="st_row2">
            <label class="st_field">
              <span class="st_label">Platform fee (%)</span>
              <input id="pm_platform_fee" class="st_input" type="number" step="0.01" min="0" placeholder="e.g. 15" />
            </label>

            <label class="st_field">
              <span class="st_label">Payment fee (%)</span>
              <input id="pm_payment_fee" class="st_input" type="number" step="0.01" min="0" placeholder="e.g. 2.9" />
            </label>
          </div>

          <div class="st_row2">
            <label class="st_field">
              <span class="st_label">Shipping cost (per order)</span>
              <input id="pm_shipping" class="st_input" type="number" step="0.01" min="0" placeholder="e.g. 5.00" />
            </label>

            <label class="st_field">
              <span class="st_label">Ad cost per order</span>
              <input id="pm_ads" class="st_input" type="number" step="0.01" min="0" placeholder="e.g. 10.00" />
            </label>
          </div>

          <div class="st_hint">
            Tip: Leave fields empty if you don’t have the value yet. Empty = 0.
          </div>
        </div>
      </div>

      <!-- Right: Results -->
      <aside class="st_card st_results" aria-label="Results">
        <div class="st_resultsTop">
          <h2 class="st_cardTitle">Results</h2>
          <div class="st_sub">Updates instantly as you type.</div>
        </div>

        <div class="st_resultMain">
          <div class="st_resultBlock">
            <div class="st_resultLabel">Net Profit</div>
            <div class="st_resultValue" id="pm_net_profit">$0.00</div>
          </div>

          <div class="st_divider"></div>

          <div class="st_resultBlock">
            <div class="st_resultLabel">Net Margin</div>
            <div class="st_resultValue" id="pm_net_margin">0%</div>
          </div>
        </div>

        <div class="st_breakdown" aria-label="Breakdown">
          <div class="st_breakRow">
            <span>Platform fee</span><span id="pm_fee_platform">$0.00</span>
          </div>
          <div class="st_breakRow">
            <span>Payment fee</span><span id="pm_fee_payment">$0.00</span>
          </div>
          <div class="st_breakRow">
            <span>Total variable costs</span><span id="pm_total_costs">$0.00</span>
          </div>
        </div>

        <div class="st_note">
          This tool is for estimating per-order profitability. Taxes are not included.
        </div>

        <a class="st_back" href="/tools/e-commerce/">← Back to E-commerce Tools</a>
      </aside>
    </section>

    <!-- AdSense-safe content blocks (same minimal style) -->
    <section class="container st_info" aria-label="How it works and FAQ">
      <div class="st_infoGrid">
        <article class="st_infoCard">
          <h2 class="st_h2">How it works</h2>
          <p class="st_p">
            We subtract all costs from the selling price. Percentage-based fees are calculated from revenue (price),
            while shipping and ad spend are treated as fixed costs per order.
          </p>
        </article>

        <article class="st_infoCard">
          <h2 class="st_h2">Formula</h2>
          <pre class="st_code">Net profit =
Price
− COGS
− (Platform fee % × Price)
− (Payment fee % × Price)
− Shipping
− Ads

Net margin (%) =
(Net profit ÷ Price) × 100</pre>
        </article>

        <article class="st_infoCard">
          <h2 class="st_h2">When to use this</h2>
          <ul class="st_list">
            <li>Before launching a product (pricing sanity check)</li>
            <li>Before running ads (confirm you can afford your CPO)</li>
            <li>When margins feel “lower than expected” (fees + ads usually explain it)</li>
          </ul>
        </article>

        <article class="st_infoCard">
          <h2 class="st_h2">Common mistakes</h2>
          <ul class="st_list">
            <li>Ignoring ad cost per order (often the biggest margin killer)</li>
            <li>Using rough fee estimates instead of platform + payment fees</li>
            <li>Forgetting shipping/packaging as a per-order cost</li>
          </ul>
        </article>

        <article class="st_infoCard st_wide">
          <h2 class="st_h2">FAQ</h2>
          <div class="st_faq">
            <div class="st_qa">
              <div class="st_q">Does this include taxes?</div>
              <div class="st_a">No. Taxes vary by state and are not included in this calculation.</div>
            </div>
            <div class="st_qa">
              <div class="st_q">Which platforms is this for?</div>
              <div class="st_a">Amazon, Shopify, Etsy, or any platform with percent-based fees.</div>
            </div>
            <div class="st_qa">
              <div class="st_q">Is this calculator free?</div>
              <div class="st_a">Yes. No login or payment is required.</div>
            </div>
            <div class="st_qa">
              <div class="st_q">Why is my margin lower than expected?</div>
              <div class="st_a">Ad spend and stacked fees often take more than sellers assume. Use the breakdown to see where it goes.</div>
            </div>
            <div class="st_qa">
              <div class="st_q">Can I use this to set ad budgets?</div>
              <div class="st_a">Yes. Your net profit gives a realistic ceiling for cost-per-order if you want to stay profitable.</div>
            </div>
          </div>
        </article>

        <article class="st_infoCard st_wide">
          <h2 class="st_h2">About this tool</h2>
          <p class="st_p">
            {site.name} provides free, no-login calculators for faster business decisions.
            Each calculator includes clear formulas and practical context to help you trust the result.
          </p>
        </article>
      </div>
    </section>
  </main>

  <style>
    /* ===== Base (matches your minimal system: border, soft bg, muted) ===== */
    .st_calc { padding: 18px 0 10px; }
    .container { width: min(1120px, calc(100% - 32px)); margin: 0 auto; }

    .st_badgeRow { display:flex; gap:10px; align-items:center; }
    .st_badge{
      display:inline-flex; align-items:center;
      font-size:12px; font-weight:900;
      padding:8px 10px; border-radius: 999px;
      border:1px solid rgba(2,6,23,.10);
      background: rgba(255,255,255,.75);
    }

    .st_calcHeader{ padding: 10px 0 14px; }
    .st_calcTitle{
      margin: 10px 0 6px;
      font-size: 28px;
      letter-spacing: -0.03em;
      font-weight: 950;
      line-height: 1.12;
    }
    .st_calcLead{
      margin: 0;
      font-size: 13px;
      line-height: 1.65;
      color: var(--muted);
      max-width: 720px;
    }

    /* ===== Cards ===== */
    .st_card{
      border: 1px solid rgba(2,6,23,.10);
      background: rgba(255,255,255,.75);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 10px 30px rgba(15,23,42,.05);
    }
    .st_cardTitle{
      margin: 0 0 12px;
      font-size: 13px;
      font-weight: 950;
      letter-spacing: -0.02em;
    }

    /* ===== Layout: 2-col desktop ===== */
    .st_calcGrid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 14px;
      align-items: start;
      padding: 10px 0 16px;
    }

    /* ===== Inputs ===== */
    .st_form{ display:grid; gap: 12px; }
    .st_field{ display:grid; gap: 6px; }
    .st_label{ font-size:12px; font-weight: 800; }
    .st_input{
      width:100%;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(2,6,23,.12);
      background: rgba(255,255,255,.90);
      font-size: 14px;
      outline: none;
    }
    .st_input:focus{
      border-color: rgba(2,6,23,.25);
      box-shadow: 0 0 0 3px rgba(2,6,23,.06);
    }
    .st_row2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .st_hint{
      font-size: 12px;
      color: var(--muted);
      padding-top: 4px;
    }

    /* ===== Results ===== */
    .st_resultsTop{ display:flex; justify-content:space-between; align-items: baseline; gap:10px; }
    .st_sub{ font-size:12px; color: var(--muted); font-weight: 700; }

    .st_resultMain{
      margin-top: 8px;
      border-radius: 14px;
      border: 1px solid rgba(2,6,23,.10);
      background: rgba(2,6,23,.02);
      padding: 14px;
    }
    .st_resultBlock{ display:flex; justify-content:space-between; align-items: baseline; gap: 10px; }
    .st_resultLabel{ font-size:12px; color: var(--muted); font-weight: 800; }
    .st_resultValue{
      font-size: 22px;
      font-weight: 950;
      letter-spacing: -0.02em;
    }
    .st_divider{
      height: 1px;
      background: rgba(2,6,23,.10);
      margin: 12px 0;
    }

    .st_breakdown{
      margin-top: 12px;
      display:grid;
      gap: 8px;
      font-size: 12px;
      color: var(--muted);
    }
    .st_breakRow{
      display:flex;
      justify-content:space-between;
      gap: 10px;
      padding: 10px 12px;
      border: 1px solid rgba(2,6,23,.08);
      border-radius: 12px;
      background: rgba(255,255,255,.65);
      font-weight: 800;
    }

    .st_note{
      margin-top: 12px;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.6;
    }

    .st_back{
      display:inline-flex;
      margin-top: 12px;
      font-size: 12px;
      font-weight: 900;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(2,6,23,.10);
      background: rgba(255,255,255,.80);
      text-decoration: none;
      color: inherit;
      width: fit-content;
    }

    /* ===== Info blocks (AdSense-safe content) ===== */
    .st_info{ padding: 6px 0 30px; }
    .st_infoGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .st_infoCard{
      border: 1px solid rgba(2,6,23,.10);
      background: rgba(255,255,255,.75);
      border-radius: 16px;
      padding: 14px;
      box-shadow: 0 10px 30px rgba(15,23,42,.05);
    }
    .st_wide{ grid-column: 1 / -1; }

    .st_h2{
      margin: 0 0 8px;
      font-size: 13px;
      font-weight: 950;
      letter-spacing: -0.02em;
    }
    .st_p{
      margin: 0;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.65;
    }
    .st_code{
      margin: 0;
      font-size: 12px;
      line-height: 1.55;
      background: rgba(2,6,23,.04);
      border: 1px solid rgba(2,6,23,.08);
      border-radius: 12px;
      padding: 10px 12px;
      overflow:auto;
      white-space: pre;
    }
    .st_list{
      margin: 0;
      padding-left: 16px;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.75;
      font-weight: 800;
    }

    .st_faq{ display:grid; gap: 10px; }
    .st_qa{
      padding: 10px 12px;
      border-radius: 12px;
      background: rgba(2,6,23,.03);
      border: 1px solid rgba(2,6,23,.08);
    }
    .st_q{ font-weight: 950; font-size: 12px; margin-bottom: 4px; }
    .st_a{ font-size: 12px; color: var(--muted); line-height: 1.6; font-weight: 800; }

    /* ===== Responsive ===== */
    @media (max-width: 900px){
      .st_calcGrid{ grid-template-columns: 1fr; }
      .st_row2{ grid-template-columns: 1fr; }
      .st_infoGrid{ grid-template-columns: 1fr; }
      .st_calcTitle{ font-size: 24px; }
    }
  </style>

  <script is:inline>
    (function () {
      const $ = (id) => document.getElementById(id);

      const el = {
        price: $("pm_price"),
        cogs: $("pm_cogs"),
        platformFee: $("pm_platform_fee"),
        paymentFee: $("pm_payment_fee"),
        shipping: $("pm_shipping"),
        ads: $("pm_ads"),
        netProfit: $("pm_net_profit"),
        netMargin: $("pm_net_margin"),
        feePlatform: $("pm_fee_platform"),
        feePayment: $("pm_fee_payment"),
        totalCosts: $("pm_total_costs"),
      };

      const inputs = [el.price, el.cogs, el.platformFee, el.paymentFee, el.shipping, el.ads];

      function n(v) {
        const x = Number(v);
        return Number.isFinite(x) ? x : 0;
      }
      function money(v) {
        return v.toLocaleString("en-US", { style: "currency", currency: "USD" });
      }

      function calc() {
        const price = n(el.price.value);
        const cogs = n(el.cogs.value);
        const platformPct = n(el.platformFee.value) / 100;
        const paymentPct = n(el.paymentFee.value) / 100;
        const shipping = n(el.shipping.value);
        const ads = n(el.ads.value);

        const platformFee = price * platformPct;
        const paymentFee = price * paymentPct;

        const net = price - cogs - platformFee - paymentFee - shipping - ads;
        const margin = price > 0 ? (net / price) * 100 : 0;

        const totalVariableCosts = cogs + platformFee + paymentFee + shipping + ads;

        el.netProfit.textContent = money(net);
        el.netMargin.textContent = price > 0 ? margin.toFixed(1) + "%" : "0%";
        el.feePlatform.textContent = money(platformFee);
        el.feePayment.textContent = money(paymentFee);
        el.totalCosts.textContent = money(totalVariableCosts);
      }

      inputs.forEach((i) => i && i.addEventListener("input", calc));
      calc();
    })();
  </script>
</BaseLayout>
